<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Code Visualization - Project {{ project_id }}</title>
    <link rel="icon" type="image/x-icon" href="/static/images/favicon.ico">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/cytoscape/3.21.0/cytoscape.min.js"></script>
    {% load static %}
</head>
<body class="bg-gray-100 min-h-screen">
    <div class="container mx-auto px-4 py-8">
        <!-- Header -->
        <header class="mb-8">
            <div class="flex justify-between items-center">
                <div>
                    <h1 class="text-3xl font-bold text-gray-800">Project: {{ project_name }}</h1>
                    {% if project_description %}
                    <p class="text-gray-600 mt-2">{{ project_description }}</p>
                    {% endif %}
                </div>
                <a href="/" class="bg-gray-500 hover:bg-gray-600 text-white font-medium py-2 px-4 rounded-lg transition duration-200">
                    Back to Projects
                </a>
            </div>
        </header>

        <!-- Navigation Tabs -->
        <div class="mb-8 border-b border-gray-200">
            <nav class="flex space-x-8">
                <button onclick="showTab('flowchart')" class="tab-button py-4 px-1 border-b-2 border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300">
                    Flowchart
                </button>
                <button onclick="showTab('erd')" class="tab-button py-4 px-1 border-b-2 border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300">
                    Database ERD
                </button>
                <button onclick="showTab('dependency')" class="tab-button py-4 px-1 border-b-2 border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300">
                    Dependency Graph
                </button>
                <button onclick="showTab('component')" class="tab-button py-4 px-1 border-b-2 border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300">
                    Component Diagram
                </button>
            </nav>
        </div>

        <!-- Visualization Content -->
        <main>
            <!-- Flowchart Tab -->
            <section id="flowchart-tab" class="tab-content hidden">
                <div class="bg-white rounded-lg shadow-md p-6 mb-8">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-2xl font-semibold">Control Flow Diagram</h2>
                        <div class="flex space-x-4">
                            <select id="file-selector" class="border border-gray-300 rounded px-3 py-2" onchange="loadFlowchart()">
                                <option value="">Select a file</option>
                                <option value="models.py">models.py</option>
                                <option value="views.py">views.py</option>
                                <option value="utils.py">utils.py</option>
                                <option value="order.py">order.py</option>
                                <option value="user.py">user.py</option>
                            </select>
                            <select id="function-selector" class="border border-gray-300 rounded px-3 py-2" onchange="loadFlowchart()">
                                <option value="">Select a function</option>
                                <option value="process_order">process_order</option>
                                <option value="validate_user">validate_user</option>
                                <option value="calculate_total">calculate_total</option>
                                <option value="send_email">send_email</option>
                            </select>
                        </div>
                    </div>
                    <div id="flowchart-container" class="border border-gray-200 rounded-lg h-96 flex items-center justify-center">
                        <div class="text-center text-gray-500">
                            <p>Select a file and function to generate flowchart</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Database ERD Tab -->
            <section id="erd-tab" class="tab-content hidden">
                <div class="bg-white rounded-lg shadow-md p-6 mb-8">
                    <h2 class="text-2xl font-semibold mb-6">Database Schema ERD</h2>
                    <div id="erd-container" class="border border-gray-200 rounded-lg h-96 flex items-center justify-center">
                        <div class="text-center">
                            <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto mb-4"></div>
                            <p class="text-gray-500">Generating database schema...</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Dependency Graph Tab -->
            <section id="dependency-tab" class="tab-content hidden">
                <div class="bg-white rounded-lg shadow-md p-6 mb-8">
                    <h2 class="text-2xl font-semibold mb-6">Dependency Graph</h2>
                    <div id="dependency-graph-container" class="border border-gray-200 rounded-lg h-96 flex items-center justify-center">
                        <div class="text-center">
                            <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-green-500 mx-auto mb-4"></div>
                            <p class="text-gray-500">Generating dependency graph...</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Component Diagram Tab -->
            <section id="component-tab" class="tab-content hidden">
                <div class="bg-white rounded-lg shadow-md p-6 mb-8">
                    <h2 class="text-2xl font-semibold mb-6">Component Diagram</h2>
                    <div id="component-diagram-container" class="border border-gray-200 rounded-lg h-96 flex items-center justify-center">
                        <div class="text-center">
                            <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-purple-500 mx-auto mb-4"></div>
                            <p class="text-gray-500">Generating component diagram...</p>
                        </div>
                    </div>
                </div>
            </section>
        </main>

        <!-- Footer -->
        <footer class="text-center text-gray-500 text-sm py-8 border-t border-gray-200 mt-8">
            <p>Code-to-Architecture Visualizer &copy; 2025</p>
        </footer>
    </div>

    <script>
        // Global variables
        let currentProjectId = "{{ project_id }}";
        
        // Show specific tab and hide others
        function showTab(tabName) {
            // Hide all tabs
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.add('hidden');
            });
            
            // Show selected tab
            document.getElementById(tabName + '-tab').classList.remove('hidden');
            
            // Update active tab button
            document.querySelectorAll('.tab-button').forEach(button => {
                button.classList.remove('border-blue-500', 'text-blue-600');
                button.classList.add('text-gray-500', 'hover:text-gray-700', 'hover:border-gray-300');
            });
            
            // Highlight active tab button
            event.target.classList.add('border-blue-500', 'text-blue-600');
            event.target.classList.remove('text-gray-500', 'hover:text-gray-700', 'hover:border-gray-300');
            
            // Load content for the selected tab
            switch(tabName) {
                case 'flowchart':
                    // Flowchart is loaded on demand when user selects file/function
                    break;
                case 'erd':
                    loadERD();
                    break;
                case 'dependency':
                    loadDependencyGraph();
                    break;
                case 'component':
                    loadComponentDiagram();
                    break;
            }
        }
        
        // Load flowchart based on selected file and function
        function loadFlowchart() {
            const fileSelector = document.getElementById('file-selector');
            const functionSelector = document.getElementById('function-selector');
            
            const selectedFile = fileSelector.value;
            const selectedFunction = functionSelector.value;
            
            if (selectedFile && selectedFunction) {
                const container = document.getElementById('flowchart-container');
                container.innerHTML = '<div class="text-center"><p class="text-gray-500 mb-4">Generating flowchart...</p><div class="animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto"></div></div>';
                
                // Fetch actual flowchart data from the backend for this specific project
                fetch(`/flowchart/${currentProjectId}/${selectedFile}/${selectedFunction}/`)
                    .then(response => response.json())
                    .then(data => {
                        if (data.status === 'success') {
                            // Create a flowchart using Cytoscape.js with the actual data
                            container.innerHTML = '<div id="cy-flowchart" style="width: 100%; height: 100%;"></div>';
                            
                            const cy = cytoscape({
                                container: document.getElementById('cy-flowchart'),
                                elements: data.data.nodes.concat(data.data.edges),
                                style: [
                                    {
                                        selector: 'node',
                                        style: {
                                            'background-color': '#4a90e2',
                                            'label': 'data(label)',
                                            'color': '#fff',
                                            'text-valign': 'center',
                                            'text-halign': 'center',
                                            'width': 100,
                                            'height': 40,
                                            'shape': 'round-rectangle'
                                        }
                                    },
                                    {
                                        selector: 'node[type = "start"]',
                                        style: {
                                            'background-color': '#50c878',
                                            'shape': 'ellipse'
                                        }
                                    },
                                    {
                                        selector: 'node[type = "end"]',
                                        style: {
                                            'background-color': '#ff6347',
                                            'shape': 'ellipse'
                                        }
                                    },
                                    {
                                        selector: 'node[type = "decision"]',
                                        style: {
                                            'background-color': '#ffa500',
                                            'shape': 'diamond',
                                            'width': 80,
                                            'height': 80
                                        }
                                    },
                                    {
                                        selector: 'edge',
                                        style: {
                                            'width': 2,
                                            'line-color': '#888',
                                            'target-arrow-color': '#888',
                                            'target-arrow-shape': 'triangle',
                                            'curve-style': 'bezier',
                                            'label': 'data(label)',
                                            'text-background-color': '#fff',
                                            'text-background-opacity': 1
                                        }
                                    }
                                ],
                                layout: {
                                    name: 'dagre',
                                    rankDir: 'TB'
                                }
                            });
                        } else {
                            container.innerHTML = `<div class="text-center text-red-500"><p>Error: ${data.message}</p></div>`;
                        }
                    })
                    .catch(error => {
                        console.error('Error fetching flowchart data:', error);
                        container.innerHTML = '<div class="text-center text-red-500"><p>Error loading flowchart data</p></div>';
                    });
            }
        }
        
        // Load ERD diagram
        function loadERD() {
            const container = document.getElementById('erd-container');
            container.innerHTML = '<div class="text-center"><p class="text-gray-500 mb-4">Generating ERD...</p><div class="animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto"></div></div>';
            
            // Simulate loading delay
            setTimeout(() => {
                // Create a simple ERD using Cytoscape.js
                container.innerHTML = '<div id="cy-erd" style="width: 100%; height: 100%;"></div>';
                
                const cy = cytoscape({
                    container: document.getElementById('cy-erd'),
                    elements: [
                        // Tables
                        { data: { id: 'user', label: 'User' }, classes: 'table' },
                        { data: { id: 'order', label: 'Order' }, classes: 'table' },
                        { data: { id: 'product', label: 'Product' }, classes: 'table' },
                        { data: { id: 'order_item', label: 'OrderItem' }, classes: 'table' },
                        
                        // Fields
                        { data: { id: 'user_id', label: 'id (PK)' }, classes: 'field pk' },
                        { data: { id: 'user_name', label: 'username' }, classes: 'field' },
                        { data: { id: 'user_email', label: 'email' }, classes: 'field' },
                        
                        { data: { id: 'order_id', label: 'id (PK)' }, classes: 'field pk' },
                        { data: { id: 'order_user_id', label: 'user_id (FK)' }, classes: 'field fk' },
                        { data: { id: 'order_total', label: 'total' }, classes: 'field' },
                        
                        { data: { id: 'product_id', label: 'id (PK)' }, classes: 'field pk' },
                        { data: { id: 'product_name', label: 'name' }, classes: 'field' },
                        { data: { id: 'product_price', label: 'price' }, classes: 'field' },
                        
                        { data: { id: 'oi_id', label: 'id (PK)' }, classes: 'field pk' },
                        { data: { id: 'oi_order_id', label: 'order_id (FK)' }, classes: 'field fk' },
                        { data: { id: 'oi_product_id', label: 'product_id (FK)' }, classes: 'field fk' },
                        { data: { id: 'oi_quantity', label: 'quantity' }, classes: 'field' },
                        
                        // Relationships
                        { data: { source: 'user', target: 'user_id' } },
                        { data: { source: 'user', target: 'user_name' } },
                        { data: { source: 'user', target: 'user_email' } },
                        
                        { data: { source: 'order', target: 'order_id' } },
                        { data: { source: 'order', target: 'order_user_id' } },
                        { data: { source: 'order', target: 'order_total' } },
                        
                        { data: { source: 'product', target: 'product_id' } },
                        { data: { source: 'product', target: 'product_name' } },
                        { data: { source: 'product', target: 'product_price' } },
                        
                        { data: { source: 'order_item', target: 'oi_id' } },
                        { data: { source: 'order_item', target: 'oi_order_id' } },
                        { data: { source: 'order_item', target: 'oi_product_id' } },
                        { data: { source: 'order_item', target: 'oi_quantity' } },
                        
                        // Foreign key relationships
                        { data: { source: 'order_user_id', target: 'user_id', label: 'FK' }, classes: 'relationship' },
                        { data: { source: 'oi_order_id', target: 'order_id', label: 'FK' }, classes: 'relationship' },
                        { data: { source: 'oi_product_id', target: 'product_id', label: 'FK' }, classes: 'relationship' }
                    ],
                    style: [
                        {
                            selector: 'node.table',
                            style: {
                                'background-color': '#4a90e2',
                                'label': 'data(label)',
                                'color': '#fff',
                                'text-valign': 'top',
                                'text-halign': 'center',
                                'width': 120,
                                'height': 30,
                                'shape': 'round-rectangle'
                            }
                        },
                        {
                            selector: 'node.field',
                            style: {
                                'background-color': '#f0f0f0',
                                'label': 'data(label)',
                                'color': '#333',
                                'text-valign': 'center',
                                'text-halign': 'left',
                                'text-margin-x': 5,
                                'width': 120,
                                'height': 25,
                                'shape': 'round-rectangle',
                                'font-size': 12
                            }
                        },
                        {
                            selector: 'node.field.pk',
                            style: {
                                'background-color': '#50c878',
                                'color': '#fff'
                            }
                        },
                        {
                            selector: 'node.field.fk',
                            style: {
                                'background-color': '#ffa500',
                                'color': '#fff'
                            }
                        },
                        {
                            selector: 'edge',
                            style: {
                                'width': 1,
                                'line-color': '#888',
                                'curve-style': 'bezier'
                            }
                        },
                        {
                            selector: 'edge.relationship',
                            style: {
                                'width': 2,
                                'line-color': '#ff6347',
                                'target-arrow-color': '#ff6347',
                                'target-arrow-shape': 'triangle',
                                'curve-style': 'bezier',
                                'label': 'data(label)',
                                'text-background-color': '#fff',
                                'text-background-opacity': 1
                            }
                        }
                    ],
                    layout: {
                        name: 'cola',
                        animate: true,
                        refresh: 50
                    }
                });
            }, 1000);
        }

        // Improved Visualization functions with better spacing and clarity
        function loadDependencyGraph() {
            const container = document.getElementById('dependency-graph-container');
            container.innerHTML = '<div class="text-center"><p class="text-gray-500 mb-4">Generating dependency graph...</p><div class="animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto"></div></div>';
            
            // Simulate loading delay
            setTimeout(() => {
                // Create a clean, organized flowchart-style dependency graph
                container.innerHTML = '<div id="cy-dependency" style="width: 100%; height: 100%;"></div>';
                
                const cy = cytoscape({
                    container: document.getElementById('cy-dependency'),
                    elements: [
                        // Entry point
                        { data: { id: 'main.py', label: 'main.py' }, classes: 'file' },
                        
                        // Core application
                        { data: { id: 'app.py', label: 'app.py' }, classes: 'file' },
                        
                        // Core modules (same level)
                        { data: { id: 'models.py', label: 'models.py' }, classes: 'file' },
                        { data: { id: 'views.py', label: 'views.py' }, classes: 'file' },
                        { data: { id: 'utils.py', label: 'utils.py' }, classes: 'file' },
                        
                        // Folders (next level)
                        { data: { id: 'controllers/', label: 'controllers/' }, classes: 'folder' },
                        { data: { id: 'services/', label: 'services/' }, classes: 'folder' },
                        
                        // Folder contents
                        { data: { id: 'user.py', label: 'user.py' }, classes: 'file' },
                        { data: { id: 'auth.py', label: 'auth.py' }, classes: 'file' },
                        { data: { id: 'email.py', label: 'email.py' }, classes: 'file' },
                        { data: { id: 'payment.py', label: 'payment.py' }, classes: 'file' },
                        
                        // Configuration (bottom)
                        { data: { id: 'config/', label: 'config/' }, classes: 'folder' },
                        { data: { id: 'settings.py', label: 'settings.py' }, classes: 'file' },
                        { data: { id: 'database.py', label: 'database.py' }, classes: 'file' },
                        
                        // Links
                        { data: { source: 'main.py', target: 'app.py' } },
                        { data: { source: 'app.py', target: 'models.py' } },
                        { data: { source: 'app.py', target: 'views.py' } },
                        { data: { source: 'app.py', target: 'utils.py' } },
                        { data: { source: 'app.py', target: 'controllers/' } },
                        { data: { source: 'app.py', target: 'services/' } },
                        { data: { source: 'app.py', target: 'config/' } },
                        
                        // Controllers
                        { data: { source: 'controllers/', target: 'user.py' } },
                        { data: { source: 'controllers/', target: 'auth.py' } },
                        { data: { source: 'user.py', target: 'services/' } },
                        { data: { source: 'auth.py', target: 'services/' } },
                        
                        // Services
                        { data: { source: 'services/', target: 'email.py' } },
                        { data: { source: 'services/', target: 'payment.py' } },
                        
                        // Configuration
                        { data: { source: 'config/', target: 'settings.py' } },
                        { data: { source: 'settings.py', target: 'database.py' } },
                        
                        // Cross-references
                        { data: { source: 'views.py', target: 'models.py' } },
                        { data: { source: 'user.py', target: 'models.py' } }
                    ],
                    style: [
                        {
                            selector: 'node.file',
                            style: {
                                'background-color': '#4ecdc4',
                                'label': 'data(label)',
                                'color': '#fff',
                                'text-valign': 'center',
                                'text-halign': 'center',
                                'width': 100,
                                'height': 30,
                                'shape': 'round-rectangle'
                            }
                        },
                        {
                            selector: 'node.folder',
                            style: {
                                'background-color': '#e0e0e0',
                                'label': 'data(label)',
                                'color': '#333',
                                'text-valign': 'center',
                                'text-halign': 'center',
                                'width': 100,
                                'height': 30,
                                'shape': 'round-rectangle'
                            }
                        },
                        {
                            selector: 'node.file[id = "main.py"]',
                            style: {
                                'background-color': '#ff6b6b'
                            }
                        },
                        {
                            selector: 'node.file[id = "models.py"]',
                            style: {
                                'background-color': '#45b7d1'
                            }
                        },
                        {
                            selector: 'node.file[id = "views.py"]',
                            style: {
                                'background-color': '#96ceb4'
                            }
                        },
                        {
                            selector: 'node.file[id = "utils.py"]',
                            style: {
                                'background-color': '#feca57'
                            }
                        },
                        {
                            selector: 'node.file[id = "user.py"], node.file[id = "auth.py"]',
                            style: {
                                'background-color': '#a061d1'
                            }
                        },
                        {
                            selector: 'node.file[id = "email.py"], node.file[id = "payment.py"]',
                            style: {
                                'background-color': '#ff9ff3'
                            }
                        },
                        {
                            selector: 'edge',
                            style: {
                                'width': 2,
                                'line-color': '#666',
                                'target-arrow-color': '#666',
                                'target-arrow-shape': 'triangle',
                                'curve-style': 'bezier'
                            }
                        }
                    ],
                    layout: {
                        name: 'dagre',
                        rankDir: 'TB'
                    }
                });
            }, 1000);
        }
        
        function loadComponentDiagram() {
            const container = document.getElementById('component-diagram-container');
            container.innerHTML = '<div class="text-center"><p class="text-gray-500 mb-4">Generating component diagram...</p><div class="animate-spin rounded-full h-12 w-12 border-b-2 border-green-500 mx-auto"></div></div>';
            
            // Simulate loading delay
            setTimeout(() => {
                // Create a clean, organized component diagram
                container.innerHTML = '<div id="cy-component" style="width: 100%; height: 100%;"></div>';
                
                const cy = cytoscape({
                    container: document.getElementById('cy-component'),
                    elements: [
                        // Entry point
                        { data: { id: 'main.py', label: 'main.py' }, classes: 'file' },
                        
                        // Core components
                        { data: { id: 'Application', label: 'Application' }, classes: 'component' },
                        { data: { id: 'Router', label: 'Router' }, classes: 'component' },
                        
                        // Services and Models
                        { data: { id: 'Auth Service', label: 'Auth Service' }, classes: 'service' },
                        { data: { id: 'User Service', label: 'User Service' }, classes: 'service' },
                        { data: { id: 'Data Model', label: 'Data Model' }, classes: 'model' },
                        { data: { id: 'API Client', label: 'API Client' }, classes: 'service' },
                        
                        // Utilities
                        { data: { id: 'Logger', label: 'Logger' }, classes: 'utility' },
                        { data: { id: 'Validator', label: 'Validator' }, classes: 'utility' },
                        { data: { id: 'Formatter', label: 'Formatter' }, classes: 'utility' },
                        { data: { id: 'Cache', label: 'Cache' }, classes: 'utility' },
                        { data: { id: 'Notifier', label: 'Notifier' }, classes: 'utility' },
                        
                        // External systems
                        { data: { id: 'Database', label: 'Database' }, classes: 'external' },
                        { data: { id: 'External API', label: 'External API' }, classes: 'external' },
                        
                        // Links
                        { data: { source: 'main.py', target: 'Application' } },
                        { data: { source: 'main.py', target: 'Router' } },
                        
                        // Application connections
                        { data: { source: 'Application', target: 'Auth Service' } },
                        { data: { source: 'Application', target: 'User Service' } },
                        { data: { source: 'Application', target: 'Data Model' } },
                        { data: { source: 'Application', target: 'API Client' } },
                        
                        // Router connections
                        { data: { source: 'Router', target: 'Auth Service' } },
                        { data: { source: 'Router', target: 'User Service' } },
                        
                        // Service to utility connections
                        { data: { source: 'Auth Service', target: 'Logger' } },
                        { data: { source: 'Auth Service', target: 'Validator' } },
                        { data: { source: 'User Service', target: 'Formatter' } },
                        { data: { source: 'User Service', target: 'Cache' } },
                        { data: { source: 'API Client', target: 'Notifier' } },
                        
                        // Data flow to external systems
                        { data: { source: 'Data Model', target: 'Database' } },
                        { data: { source: 'Auth Service', target: 'Database' } },
                        { data: { source: 'User Service', target: 'Database' } },
                        { data: { source: 'Application', target: 'External API' } },
                        { data: { source: 'API Client', target: 'External API' } }
                    ],
                    style: [
                        {
                            selector: 'node.component',
                            style: {
                                'background-color': '#4ecdc4',
                                'label': 'data(label)',
                                'color': '#fff',
                                'text-valign': 'center',
                                'text-halign': 'center',
                                'width': 110,
                                'height': 40,
                                'shape': 'round-rectangle'
                            }
                        },
                        {
                            selector: 'node.service',
                            style: {
                                'background-color': '#feca57',
                                'label': 'data(label)',
                                'color': '#fff',
                                'text-valign': 'center',
                                'text-halign': 'center',
                                'width': 100,
                                'height': 40,
                                'shape': 'ellipse'
                            }
                        },
                        {
                            selector: 'node.model',
                            style: {
                                'background-color': '#96ceb4',
                                'label': 'data(label)',
                                'color': '#fff',
                                'text-valign': 'center',
                                'text-halign': 'center',
                                'width': 100,
                                'height': 35,
                                'shape': 'rectangle'
                            }
                        },
                        {
                            selector: 'node.utility',
                            style: {
                                'background-color': '#ff9ff3',
                                'label': 'data(label)',
                                'color': '#fff',
                                'text-valign': 'center',
                                'text-halign': 'center',
                                'width': 90,
                                'height': 30,
                                'shape': 'polygon',
                                'shape-polygon-points': '-0.5 -1 0 -0.5 0.5 -1 1 0 0.5 1 -0.5 1 -1 0 -0.5 -1'
                            }
                        },
                        {
                            selector: 'node.external',
                            style: {
                                'background-color': '#a8e6cf',
                                'label': 'data(label)',
                                'color': '#fff',
                                'text-valign': 'center',
                                'text-halign': 'center',
                                'width': 100,
                                'height': 40,
                                'shape': 'barrel'
                            }
                        },
                        {
                            selector: 'node.file',
                            style: {
                                'background-color': '#ff6b6b',
                                'label': 'data(label)',
                                'color': '#fff',
                                'text-valign': 'center',
                                'text-halign': 'center',
                                'width': 50,
                                'height': 50,
                                'shape': 'ellipse'
                            }
                        },
                        {
                            selector: 'edge',
                            style: {
                                'width': 2,
                                'line-color': '#666',
                                'target-arrow-color': '#666',
                                'target-arrow-shape': 'triangle',
                                'curve-style': 'bezier'
                            }
                        }
                    ],
                    layout: {
                        name: 'cose',
                        animate: true,
                        refresh: 50
                    }
                });
            }, 1000);
        }

        // Initialize the page
        document.addEventListener('DOMContentLoaded', function() {
            // Show the first tab by default
            showTab('flowchart');
            
            // Highlight the first tab button
            document.querySelector('.tab-button').classList.add('border-blue-500', 'text-blue-600');
            document.querySelector('.tab-button').classList.remove('text-gray-500', 'hover:text-gray-700', 'hover:border-gray-300');
        });
    </script>
</body>
</html>